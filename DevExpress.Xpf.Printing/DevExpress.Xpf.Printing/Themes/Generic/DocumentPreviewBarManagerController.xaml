<ResourceDictionary x:Class="DevExpress.Xpf.Printing.DocumentPreviewBarManagerControllerResources"
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib"
                    xmlns:bars="http://schemas.devexpress.com/winfx/2008/xaml/bars"
                    xmlns:core="http://schemas.devexpress.com/winfx/2008/xaml/core"
                    xmlns:editors="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                    xmlns:local="clr-namespace:DevExpress.Xpf.Printing"
                    xmlns:native="clr-namespace:DevExpress.Xpf.Printing.Native"                    
                    xmlns:data="clr-namespace:DevExpress.XtraPrinting;assembly=DevExpress.Printing.v15.2.Core">

    <local:DisabledCommand x:Key="disabledCommand" />

    <sys:Double x:Key="zoomComboBoxWidth">100</sys:Double>
    <core:FormatStringConverter FormatString="/ {0}" x:Key="pageCountFormatStringConverter" />
    <DataTemplate x:Key="zoomModeItemTemplate">
        <TextBlock Text="{Binding Path=DisplayedText}" />
    </DataTemplate>
    <DataTemplate x:Key="separatorItemTemplate">
        <Rectangle Margin="0,1,0,1" Width="{StaticResource zoomComboBoxWidth}" Fill="Black" Height="1" />
    </DataTemplate>
    <DataTemplate x:Key="documentPreviewBarManagerControllerTemplate">
        <bars:BarManagerActionContainer>
            <!-- bars -->

            <local:AddDocumentPreviewToolBarAction>
                <bars:Bar x:Name="DocumentPreviewToolBar" Caption="{local:PrintingStringId StringId=ToolBarCaption}"
                          UseWholeRow="True" AllowQuickCustomization="False">
                    <bars:Bar.DockInfo>
                        <bars:BarDockInfo ContainerType="Top" />
                    </bars:Bar.DockInfo>
                </bars:Bar>
            </local:AddDocumentPreviewToolBarAction>
            <bars:InsertStatusBarIfNotExistAction>
                <bars:Bar x:Name="DocumentPreviewStatusBar" Caption="{local:PrintingStringId StringId=StatusBarCaption}" UseWholeRow="True">
                    <bars:Bar.DockInfo>
                        <bars:BarDockInfo ContainerType="Bottom" />
                    </bars:Bar.DockInfo>
                </bars:Bar>
            </bars:InsertStatusBarIfNotExistAction>

            <!-- bar items -->
            <bars:BarButtonItem Name="parameters"
                                Content="{local:PrintingStringId StringId=Parameters}"
                                IsVisible="{Binding RelativeSource={RelativeSource Self}, Path=IsEnabled}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Parameters_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Parameters_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.ToggleParametersPanelCommand, FallbackValueResourceKey='disabledCommand'}" />
            <bars:BarButtonItem Name="documentMap"
                                Content="{local:PrintingStringId StringId=DocumentMap}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/DocumentMap_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/DocumentMap_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.ToggleDocumentMapCommand, FallbackValueResourceKey='disabledCommand'}" />
            <bars:BarButtonItem Name="search"
                                Content="{local:PrintingStringId StringId=Search}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Find_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Find_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.ToggleSearchPanelCommand}"
                                IsVisible="{local:BarItemBinding Path=Model.IsSearchVisible}" />
            <bars:BarButtonItem Name="open" Content="{local:PrintingStringId StringId=Open}"
                                            Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Open_16x16.png}"
                                            LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Open_32x32.png}"
                                            Command="{local:BarItemBinding Path=Model.OpenCommand}"
                                            IsVisible="{local:BarItemBinding Path=Model.IsOpenButtonVisible}" />
            <bars:BarButtonItem Name="save" Content="{local:PrintingStringId StringId=Save}"
                                            Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Save_16x16.png}"
                                            LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Save_32x32.png}"
                                            Command="{local:BarItemBinding Path=Model.SaveCommand}" 
                                            IsVisible="{local:BarItemBinding Path=Model.IsSaveButtonVisible}" />
            <bars:BarButtonItem Name="print"
                                Content="{local:PrintingStringId StringId=Print}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/PrintDialog_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/PrintDialog_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.PrintCommand}"
                                CommandParameter="default" />
            <bars:BarButtonItem Name="printDirect" Content="{local:PrintingStringId StringId=PrintDirect}"
                                            Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Print_16x16.png}"
                                            LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Print_32x32.png}"
                                            Command="{local:BarItemBinding Path=Model.PrintDirectCommand}" />
            <bars:BarButtonItem Name="pageSetup"
                                Content="{local:PrintingStringId StringId=PageSetup}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/PageSetup_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/PageSetup_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.PageSetupCommand}" />

            <bars:BarButtonItem Name="scaling"
                                Content="{local:PrintingStringId StringId=Scaling}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Scaling_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Scaling_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.ScaleCommand}"
                                IsVisible="{local:BarItemBinding Path=Model.IsScaleVisible}">
            </bars:BarButtonItem>

            <bars:BarButtonItem Name="zoomOut" 
                                Content="{local:PrintingStringId StringId=DecreaseZoom}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ZoomOut_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ZoomOut_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.ZoomOutCommand}" />
            <bars:BarEditItem Name="zoom"
                              EditWidth="{StaticResource zoomComboBoxWidth}"
                              EditValue="{local:BarItemBinding Path=Model.ZoomMode, Mode=TwoWay}"
                              CustomizationContent="{local:PrintingStringId StringId=Zoom}"
                              CustomizationGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Zoom_16x16.png}">
                <bars:BarEditItem.EditSettings>
                    <editors:ComboBoxEditSettings DataContext="{Binding Path=(bars:BarEditItem.BarEditItem), RelativeSource={RelativeSource Mode=Self}}" 
                                                  ItemsSource="{local:BarItemBinding Path=Model.ZoomModes, IsBarItemTarget=False}"
                                                  IsTextEditable="False">
                        <editors:ComboBoxEditSettings.ItemTemplateSelector>
                            <local:ZoomComboBoxTemplateSelector ZoomModeItemTemplate="{StaticResource zoomModeItemTemplate}"
                                        SeparatorItemTemplate="{StaticResource separatorItemTemplate}" />
                        </editors:ComboBoxEditSettings.ItemTemplateSelector>
                    </editors:ComboBoxEditSettings>

                </bars:BarEditItem.EditSettings>
            </bars:BarEditItem>
            <bars:BarButtonItem Name="zoomIn" 
                                Content="{local:PrintingStringId StringId=IncreaseZoom}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ZoomIn_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ZoomIn_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.ZoomInCommand}" />

            <bars:BarButtonItem Name="firstPage" 
                                Content="{local:PrintingStringId StringId=FirstPage}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/First_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/First_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.FirstPageCommand}" />
            <bars:BarButtonItem Name="previousPage" 
                                Content="{local:PrintingStringId StringId=PreviousPage}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Prev_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Prev_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.PreviousPageCommand}" />
            <bars:BarButtonItem Name="nextPage" 
                                Content="{local:PrintingStringId StringId=NextPage}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Next_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Next_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.NextPageCommand}" />
            <bars:BarButtonItem Name="lastPage" 
                                Content="{local:PrintingStringId StringId=LastPage}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Last_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Last_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.LastPageCommand}" />
            <bars:BarButtonItem Name="watermark" 
                                Content="{local:PrintingStringId StringId=Watermark}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Watermark_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Watermark_32x32.png}"
                                Command="{local:BarItemBinding Path=Model.WatermarkCommand}"
                                IsVisible="{local:BarItemBinding Path=Model.IsSetWatermarkVisible}" />
            <bars:BarButtonItem Name="exportPDF"
                                Content="{local:PrintingStringId StringId=ExportPdf}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToPDF_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToPDF_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportPdf}"
                                Command="{local:BarItemBinding Path=Model.ExportCommand}"
                                CommandParameter="Pdf" />
            <bars:BarButtonItem Name="exportHTML"
                                Content="{local:PrintingStringId StringId=ExportHtm}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToHTML_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToHTML_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportHtm}"
                                Command="{local:BarItemBinding Path=Model.ExportCommand}"
                                CommandParameter="Htm" />
            <bars:BarButtonItem Name="exportMHT"
                                Content="{local:PrintingStringId StringId=ExportMht}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToMHT_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToMHT_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportMht}"
                                Command="{local:BarItemBinding Path=Model.ExportCommand}"
                                CommandParameter="Mht" />
            <bars:BarButtonItem Name="exportRTF"
                                Content="{local:PrintingStringId StringId=ExportRtf}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToRTF_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToRTF_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportRtf}"
                                Command="{local:BarItemBinding Path=Model.ExportCommand}"
                                CommandParameter="Rtf" />
            <bars:BarButtonItem Name="exportXLS"
                                Content="{local:PrintingStringId StringId=ExportXls}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXLS_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXLS_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportXls}"
                                Command="{local:BarItemBinding Path=Model.ExportCommand}"
                                CommandParameter="Xls" />
            <bars:BarButtonItem Name="exportXLSX"
                                Content="{local:PrintingStringId StringId=ExportXlsx}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXLSX_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXLSX_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportXlsx}"
                                Command="{local:BarItemBinding Path=Model.ExportCommand}"
                                CommandParameter="Xlsx" />
            <bars:BarButtonItem Name="exportCSV"
                                Content="{local:PrintingStringId StringId=ExportCsv}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToCSV_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToCSV_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportCsv}"
                                Command="{local:BarItemBinding Path=Model.ExportCommand}"
                                CommandParameter="Csv" />
            <bars:BarButtonItem Name="exportText"
                                Content="{local:PrintingStringId StringId=ExportTxt}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToText_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToText_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportTxt}"
                                Command="{local:BarItemBinding Path=Model.ExportCommand}"
                                CommandParameter="Txt" />
            <bars:BarButtonItem Name="exportImage"
                                Content="{local:PrintingStringId StringId=ExportImage}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToImage_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToImage_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportImage}"
                                Command="{local:BarItemBinding Path=Model.ExportCommand}"
                                CommandParameter="Image" />
            <bars:BarButtonItem Name="exportXPS"
                                Content="{local:PrintingStringId StringId=ExportXps}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXPS_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXPS_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportXps}"
                                Command="{local:BarItemBinding Path=Model.ExportCommand}"
                                CommandParameter="Xps" />
            <bars:BarSplitButtonItem Name="export"
                                     Content="{local:PrintingStringId StringId=ExportFile}"
                                     Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Export_16x16.png}"
                                     LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Export_32x32.png}"
                                     Hint="{local:PrintingStringId StringId=ExportFile_Hint}"
                                     Command="{local:BarItemBinding Path=Model.ExportCommand}">
                <bars:BarSplitButtonItem.PopupControl>
                    <bars:PopupMenu>
                        <bars:PopupMenu.ItemLinks>
                            <bars:BarButtonItemLink BarItemName="exportPDF" />
                            <bars:BarButtonItemLink BarItemName="exportHTML" />
                            <bars:BarButtonItemLink BarItemName="exportMHT" />
                            <bars:BarButtonItemLink BarItemName="exportRTF" />
                            <bars:BarButtonItemLink BarItemName="exportXLS" />
                            <bars:BarButtonItemLink BarItemName="exportXLSX" />
                            <bars:BarButtonItemLink BarItemName="exportCSV" />
                            <bars:BarButtonItemLink BarItemName="exportText" />
                            <bars:BarButtonItemLink BarItemName="exportImage" />
                            <bars:BarButtonItemLink BarItemName="exportXPS" />
                        </bars:PopupMenu.ItemLinks>
                    </bars:PopupMenu>
                </bars:BarSplitButtonItem.PopupControl>
            </bars:BarSplitButtonItem>

            <bars:BarButtonItem Name="emailPDF" Content="{local:PrintingStringId StringId=SendPdf}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToPDF_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToPDF_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportPdf}"
                                Command="{local:BarItemBinding Path=Model.SendCommand}"
                                CommandParameter="{x:Static data:ExportFormat.Pdf}" />
            <bars:BarButtonItem Name="emailMHT" Content="{local:PrintingStringId StringId=SendMht}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToMHT_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToMHT_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportMht}"
                                Command="{local:BarItemBinding Path=Model.SendCommand}"
                                CommandParameter="{x:Static data:ExportFormat.Mht}" />
            <bars:BarButtonItem Name="emailRTF" Content="{local:PrintingStringId StringId=SendRtf}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToRTF_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToRTF_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportRtf}"
                                Command="{local:BarItemBinding Path=Model.SendCommand}"
                                CommandParameter="{x:Static data:ExportFormat.Rtf}" />
            <bars:BarButtonItem Name="emailXLS" Content="{local:PrintingStringId StringId=SendXls}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXLS_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXLS_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportXls}"
                                Command="{local:BarItemBinding Path=Model.SendCommand}"
                                CommandParameter="{x:Static data:ExportFormat.Xls}" />
            <bars:BarButtonItem Name="emailXLSX" Content="{local:PrintingStringId StringId=SendXlsx}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXLSX_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXLSX_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportXlsx}"
                                Command="{local:BarItemBinding Path=Model.SendCommand}"
                                CommandParameter="{x:Static data:ExportFormat.Xlsx}" />
            <bars:BarButtonItem Name="emailCSV" Content="{local:PrintingStringId StringId=SendCsv}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToCSV_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToCSV_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportCsv}"
                                Command="{local:BarItemBinding Path=Model.SendCommand}"
                                CommandParameter="{x:Static data:ExportFormat.Csv}" />
            <bars:BarButtonItem Name="emailText" Content="{local:PrintingStringId StringId=SendTxt}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToText_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToText_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportTxt}"
                                Command="{local:BarItemBinding Path=Model.SendCommand}"
                                CommandParameter="{x:Static data:ExportFormat.Txt}" />
            <bars:BarButtonItem Name="emailImage" Content="{local:PrintingStringId StringId=SendImage}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToImage_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToImage_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportImage}"
                                Command="{local:BarItemBinding Path=Model.SendCommand}"
                                CommandParameter="{x:Static data:ExportFormat.Image}" />
            <bars:BarButtonItem Name="emailXPS" Content="{local:PrintingStringId StringId=SendXps}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXPS_16x16.png}"
                                LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/ExportToXPS_32x32.png}"
                                Hint="{local:PrintingStringId StringId=ExportXps}"
                                Command="{local:BarItemBinding Path=Model.SendCommand}"
                                CommandParameter="{x:Static data:ExportFormat.Xps}" />
            <bars:BarSplitButtonItem Name="email" Content="{local:PrintingStringId StringId=SendFile}"
                                     Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Mail_16x16.png}"
                                     LargeGlyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Mail_32x32.png}"
                                     Hint="{local:PrintingStringId StringId=SendFile_Hint}"
                                     Command="{local:BarItemBinding Path=Model.SendCommand}"
                                     CommandParameter="{x:Null}"
                                     IsVisible="{local:BarItemBinding Path=Model.IsSendVisible}">
                <bars:BarSplitButtonItem.PopupControl>
                    <bars:PopupMenu>
                        <bars:PopupMenu.ItemLinks>
                            <bars:BarButtonItemLink BarItemName="emailPDF" />
                            <bars:BarButtonItemLink BarItemName="emailMHT" />
                            <bars:BarButtonItemLink BarItemName="emailRTF" />
                            <bars:BarButtonItemLink BarItemName="emailXLS" />
                            <bars:BarButtonItemLink BarItemName="emailXLSX" />
                            <bars:BarButtonItemLink BarItemName="emailCSV" />
                            <bars:BarButtonItemLink BarItemName="emailText" />
                            <bars:BarButtonItemLink BarItemName="emailImage" />
                            <bars:BarButtonItemLink BarItemName="emailXPS" />
                        </bars:PopupMenu.ItemLinks>
                    </bars:PopupMenu>
                </bars:BarSplitButtonItem.PopupControl>
            </bars:BarSplitButtonItem>

            <bars:BarEditItem x:Name="pageNumber"
                              IsEnabled="{local:BarItemBinding Path=Model.PageCount, FallbackValue=False}"
                              EditValue="{local:BarItemBinding Path=Model.CurrentPageNumber, Mode=TwoWay, UpdateSourceTrigger=Explicit, FallbackValue=0}" 
                              Content="{local:PrintingStringId StringId=GoToPage}"
                              Content2="{local:BarItemBinding Path=Model.PageCount, Converter='pageCountFormatStringConverter', FallbackValue=' / 0'}"
                              ShowScreenTip="False">
                <bars:BarEditItem.EditStyle>
                    <Style TargetType="{x:Type editors:TextEdit}">
                        <Setter Property="Padding" Value="0,-2,0,-2" />
                        <Setter Property="MinWidth" Value="30" />
                    </Style>
                </bars:BarEditItem.EditStyle>
                <bars:BarEditItem.EditSettings>
                    <editors:TextEditSettings HorizontalContentAlignment="Center" MaskType="RegEx" Mask="\d{0,6}" AllowNullInput="True" />
                </bars:BarEditItem.EditSettings>
            </bars:BarEditItem>


            <bars:BarEditItem x:Name="progress"
                              EditValue="{local:BarItemBinding Path=Model.ProgressValue, Mode=OneWay}"
                              IsVisible="{local:BarItemBinding Path=Model.ProgressVisibility, FallbackValue=False}"
                              ShowScreenTip="False">
                <bars:BarEditItem.EditStyle>
                    <Style TargetType="{x:Type editors:ProgressBarEdit}">
                        <Setter Property="MinWidth" Value="150" />
                        <Setter Property="MaxHeight" Value="12" />
                    </Style>
                </bars:BarEditItem.EditStyle>
                <bars:BarEditItem.EditSettings>
                    <editors:ProgressBarEditSettings DataContext="{Binding Path=(bars:BarEditItem.BarEditItem), RelativeSource={RelativeSource Mode=Self}}" 
                                                     Minimum="0"
                                                     Maximum="{local:BarItemBinding Path=Model.ProgressMaximum, IsBarItemTarget=False}" />
                </bars:BarEditItem.EditSettings>
            </bars:BarEditItem>

            <bars:BarEditItem x:Name="progressMarquee"
                              IsVisible="{local:BarItemBinding Path=Model.ProgressMarqueeVisibility, FallbackValue=False}">
                <bars:BarEditItem.EditTemplate>
                    <DataTemplate>
                        <editors:ProgressBarEdit MinWidth="150" Height="12" >
                            <editors:ProgressBarEdit.StyleSettings>
                                <editors:ProgressBarMarqueeStyleSettings />
                            </editors:ProgressBarEdit.StyleSettings>
                        </editors:ProgressBarEdit>
                    </DataTemplate>
                </bars:BarEditItem.EditTemplate>
            </bars:BarEditItem>

            <bars:BarButtonItem x:Name="stop" Content="{local:PrintingStringId StringId=StopPageBuilding}"
                                IsVisible="{Binding RelativeSource={RelativeSource Self}, Path=IsEnabled}"
                                Glyph="{local:PrintingResourceImage ResourceName=Images/BarItems/Stop_16x16.png}"
                                Command="{local:BarItemBinding Path=Model.StopCommand, FallbackValueResourceKey='disabledCommand'}" />

            <bars:BarStaticItem Name="zoomFactor"
                                Content="{local:BarItemBinding Path=Model.ZoomDisplayText}"
                                AutoSizeMode="Fill" ContentAlignment="Right" ShowBorder="False" />

            <!-- bar item links -->
            <bars:BarButtonItemLink BarItemName="parameters" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="documentMap" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="search" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarItemLinkSeparator bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="open" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="save" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarItemLinkSeparator bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="print" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="printDirect" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="pageSetup" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="scaling" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarItemLinkSeparator bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="zoomOut" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarEditItemLink BarItemName="zoom" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="zoomIn" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarItemLinkSeparator bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="firstPage" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="previousPage" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="nextPage" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="lastPage" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarItemLinkSeparator bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarSplitButtonItemLink BarItemName="export" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarSplitButtonItemLink BarItemName="email" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarItemLinkSeparator bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarButtonItemLink BarItemName="watermark" bars:BarItemLinkActionBase.Target="DocumentPreviewToolBar" />
            <bars:BarEditItemLink BarItemName="pageNumber" bars:BarItemLinkActionBase.Target="DocumentPreviewStatusBar" native:GoToPageEditBehavior.Apply="True" />
            <bars:BarEditItemLink BarItemName="progress" bars:BarItemLinkActionBase.Target="DocumentPreviewStatusBar" />
            <bars:BarEditItemLink BarItemName="progressMarquee" bars:BarItemLinkActionBase.Target="DocumentPreviewStatusBar" />
            <bars:BarButtonItemLink BarItemName="stop" bars:BarItemLinkActionBase.Target="DocumentPreviewStatusBar" BarItemDisplayMode="ContentAndGlyph" />
            <bars:BarStaticItemLink BarItemName="zoomFactor" bars:BarItemLinkActionBase.Target="DocumentPreviewStatusBar" />

        </bars:BarManagerActionContainer>
    </DataTemplate>

    <Style TargetType="{x:Type local:DocumentPreviewBarManagerController}">
        <Setter Property="Template" Value="{StaticResource documentPreviewBarManagerControllerTemplate}" />
    </Style>
</ResourceDictionary>
