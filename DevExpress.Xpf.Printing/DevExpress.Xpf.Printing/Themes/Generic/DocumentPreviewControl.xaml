<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:DevExpress.Xpf.Printing"
                    xmlns:native="clr-namespace:DevExpress.Xpf.Printing.PreviewControl.Native"
                    xmlns:dxpn="clr-namespace:DevExpress.Xpf.Printing.Native"
                    xmlns:dxpp="clr-namespace:DevExpress.Xpf.Printing.Parameters"
                    xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/core"
                    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
                    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                    xmlns:dxt="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys"
                    xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
                    xmlns:dxd="http://schemas.devexpress.com/winfx/2008/xaml/docking"
                    xmlns:mvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
                    xmlns:themes="clr-namespace:DevExpress.Xpf.Printing.Themes"
                    xmlns:bars ="clr-namespace:DevExpress.Xpf.Printing.PreviewControl.Bars"
                    xmlns:dxdv="http://schemas.devexpress.com/winfx/2008/xaml/documentviewer"
                    xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
                    xmlns:lines="clr-namespace:DevExpress.Xpf.Printing.Native.Lines;assembly=DevExpress.Xpf.Printing.v15.2"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">
    <sys:Boolean x:Key="TrueBoolean">True</sys:Boolean>
    <sys:Boolean x:Key="FalseBoolean">false</sys:Boolean>
    <BooleanToVisibilityConverter x:Key="booleanToVisibilityConverter" />
    <dxpn:NumberToVisibilityConverter x:Key="visibilityConverter" />
    <dxpn:ObjectToCollectionConverter x:Key="objectToCollectionConverter" />
    <dxc:ObjectToBooleanConverter x:Key="objectToBooleanConverter"/>
    <dxc:BoolToVisibilityConverter x:Key="boolToVisibilityConverter"/>
    <local:CursorModeToCanMouseScrollConverter x:Key="cursorModeToCanMouseScrollConverter" />
    <sys:Double x:Key="zoomComboBoxWidth">100</sys:Double>
    <dxc:FormatStringConverter FormatString="/ {0}" x:Key="pageCountFormatStringConverter" />

    <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=PaginationTemplate}">
        <Grid Margin="10,0,10,0">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Path=(local:DocumentPreviewControl.ActualViewer).CurrentPageNumber, RelativeSource={RelativeSource TemplatedParent}}"/>
                <TextBlock Text=" / "/>
                <TextBlock Text="{Binding Path=(local:DocumentPreviewControl.ActualViewer).PageCount, RelativeSource={RelativeSource TemplatedParent}}"/>
            </StackPanel>
        </Grid>
    </DataTemplate>

    <Style TargetType="{x:Type bars:PreviewBarCheckItem}">
        <Setter Property="Content" Value="{Binding Path=Caption}"/>
        <Setter Property="Hint" Value="{Binding Path=Hint}"/>
        <Setter Property="Glyph" Value="{Binding Path=SmallGlyph, Converter={dxdv:UriToBitmapImageConverter}}"/>
        <Setter Property="LargeGlyph" Value="{Binding Path=LargeGlyph, Converter={dxdv:UriToBitmapImageConverter}}"/>
        <Setter Property="GlyphAlignment" Value="Top"/>
        <Setter Property="IsChecked" Value="{Binding Path=IsChecked}" />
    </Style>
    
    <Style TargetType="{x:Type bars:SelectToolBarItem}" BasedOn="{StaticResource {x:Type bars:PreviewBarCheckItem}}">
        <Setter Property="CommandParameter" Value="{Binding Path=CommandValue}" />
    </Style>

    <Style TargetType="{x:Type bars:HandToolBarItem}" BasedOn="{StaticResource {x:Type bars:PreviewBarCheckItem}}">
        <Setter Property="CommandParameter" Value="{Binding Path=CommandValue}" />
    </Style>

    <Style TargetType="{x:Type bars:PageNumberEditItem}">
        <Setter Property="Content" Value="{local:PrintingStringId StringId=GoToPage}" />
        <Setter Property="Content2" Value="{Binding Path=PageCount, Converter={StaticResource pageCountFormatStringConverter}}" />
        <Setter Property="EditValue" Value="{Binding Mode=TwoWay, UpdateSourceTrigger=Explicit, Path=CurrentPageNumber, FallbackValue=0}" />
        <Setter Property="EditStyle">
            <Setter.Value>
                <Style TargetType="{x:Type dxe:TextEdit}">
                    <Setter Property="IsEnabled" Value="{Binding PageCount, FallbackValue=False}" />
                    <Setter Property="Padding" Value="0,-2,0,-2" />
                    <Setter Property="MinWidth" Value="30" />
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type bars:ExportSplitItem}">
        <Setter Property="Content" Value="{Binding Path=Caption}"/>
        <Setter Property="Hint" Value="{Binding Path=Hint}"/>
        <Setter Property="Glyph" Value="{Binding Path=SmallGlyph, Converter={dxdv:UriToBitmapImageConverter}}"/>
        <Setter Property="LargeGlyph" Value="{Binding Path=LargeGlyph, Converter={dxdv:UriToBitmapImageConverter}}"/>
        <Setter Property="GlyphAlignment" Value="Top"/>
    </Style>

    <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey  ResourceKey=PopupMenuItemTemplate}">
        <DataTemplate.Resources>
            <bars:ExportFormatToItemNameConverter x:Key="exportItemToNameConverter" />
        </DataTemplate.Resources>
        <dxb:BarButtonItem Glyph="{Binding Path=SmallGlyph, Converter={dxdv:UriToBitmapImageConverter}}" 
                           Content="{Binding Path=Caption}" 
                           Command="{Binding Path=Command}"
                           CommandParameter="{Binding Format}">
            <local:DocumentPreviewControl.BarItemName>
                <MultiBinding Converter="{StaticResource exportItemToNameConverter}">
                    <Binding Path="Tag" />
                    <Binding Path="Format" />
                </MultiBinding>
            </local:DocumentPreviewControl.BarItemName>
        </dxb:BarButtonItem>
    </DataTemplate>
    
    <Style TargetType="{x:Type bars:ProgressEditItem}">
        <Setter Property="EditValue" Value="{Binding ProgressPosition, Mode=OneWay, FallbackValue=0}" />
        <Setter Property="IsVisible" Value="{Binding InProgress, FallbackValue={StaticResource FalseBoolean}}" />
        <Setter Property="EditStyle">
            <Setter.Value>
                <Style TargetType="{x:Type dxe:ProgressBarEdit}">
                    <Setter Property="MinWidth" Value="150" />
                    <Setter Property="MaxHeight" Value="12" />
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

    <Style  TargetType="{x:Type bars:StopPageBuildItem}">
        <Setter Property="IsVisible" Value="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" />
    </Style>



    <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}">
        <Grid>
            <dxpn:PreviewSurface />
            <dxd:DockLayoutManager Background="Transparent">
                <mvvm:Interaction.Behaviors>
                    <native:HideClosingItemsBehavior />
                </mvvm:Interaction.Behaviors>
                <dxd:LayoutGroup>
                    <dxd:LayoutGroup Orientation="Vertical" ItemWidth="250">
                        <dxd:LayoutPanel Caption="{local:PrintingStringId StringId=Parameters}">
                            <dxd:LayoutPanel.Visibility>
                                <MultiBinding FallbackValue="Collapsed" Mode="TwoWay" >
                                    <MultiBinding.Converter>
                                        <local:DockPanelVisibilityConverter />
                                    </MultiBinding.Converter>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleParametersPanelCommand.IsChecked" Mode="TwoWay"/>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).ParametersModel.HasVisibleParameters" Mode="OneWay" />
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).AutoShowParametersPanel" Mode="OneWay"/>
                                </MultiBinding>
                            </dxd:LayoutPanel.Visibility>
                            <dxpp:ParametersPanel ParametersModel="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ParametersModel, RelativeSource={RelativeSource TemplatedParent}}"  />
                        </dxd:LayoutPanel>
                        <dxd:LayoutPanel Caption="{local:PrintingStringId StringId=DocumentMap}">
                            <dxd:LayoutPanel.Visibility>
                                <MultiBinding FallbackValue="Collapsed" Mode="TwoWay" >
                                    <MultiBinding.Converter>
                                        <local:DockPanelVisibilityConverter />
                                    </MultiBinding.Converter>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleDocumentMapCommand.IsChecked" Mode="TwoWay"/>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).Document.HasBookmarks" Mode="OneWay" />
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="(local:DocumentPreviewControl.ActualViewer).AutoShowDocumentMap" Mode="OneWay"/>
                                </MultiBinding>
                            </dxd:LayoutPanel.Visibility>
                            <native:DocumentMap Settings="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualDocumentMapSettings, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxd:LayoutPanel>
                    </dxd:LayoutGroup>
                    <dxd:LayoutPanel Name="DocumentViewerPanel"
                                    AllowDrag="False"
                                    ShowCaption="False" 
                                    ShowBorder="False" 
                                    Background="Transparent"
                                    Caption="{local:PrintingStringId StringId=ToolBarCaption}">
                        <local:DocumentPresenterControl>
                            <dxb:BarManager.DXContextMenu>
                                <dxb:PopupMenu>
                                    <bars:HandToolBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.HandTool}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.HandToolCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <bars:SelectToolBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.SelectTool}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SelectToolCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                                    <dxb:BarItemSeparator />
                                    <bars:CopyBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Copy}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.CopyCommand, RelativeSource={RelativeSource TemplatedParent}}"  />
                                </dxb:PopupMenu>
                            </dxb:BarManager.DXContextMenu>
                        </local:DocumentPresenterControl>
                    </dxd:LayoutPanel>
                </dxd:LayoutGroup>
            </dxd:DockLayoutManager>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=BarsTemplate}">
        <Grid>            
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="auto" />
            </Grid.RowDefinitions>
            <dxb:BarContainerControl >
                <dxb:ToolBarControl  GlyphSize="Large" Caption="{local:PrintingStringId StringId=ToolBarCaption}" UseWholeRow="True" >
                    <mvvm:Interaction.Behaviors>
                        <dxb:ControllerBehavior Actions="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.Actions, RelativeSource={RelativeSource TemplatedParent}}" ExecutionMode="OnEvent">
                            <dxb:ControllerBehavior.Triggers>
                                <dxb:ActionTrigger EventName="Loaded" ExecuteOnce="True"/>
                            </dxb:ControllerBehavior.Triggers>
                        </dxb:ControllerBehavior>
                    </mvvm:Interaction.Behaviors>
                    <dxdv:OpenDocumentBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Open}"  Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.OpenDocumentCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <bars:SaveBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Save}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SaveCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <dxb:BarItemLinkSeparator />
                    <bars:ParametersBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Parameters}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleParametersPanelCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                    <bars:DocumentMapBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.DocumentMap}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleDocumentMapCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                    <bars:FindTextBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Find}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ShowFindTextCommand, RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="{StaticResource TrueBoolean}" />
                    <dxb:BarItemLinkSeparator />
                    <bars:PrintBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Print}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                    <bars:PrintDirectBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PrintDirect}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintDirectCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <bars:PageSetupBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PageSetup}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PageSetupCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <bars:ScaleBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Scale}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ScaleCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <dxb:BarItemLinkSeparator />
                    <bars:FirstPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.FirstPage}"  Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.FirstPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <dxdv:PreviousPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PreviousPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PreviousPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <dxdv:NextPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.NextPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.NextPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <bars:LastPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.LastPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.LastPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <dxb:BarItemLinkSeparator />
                    <dxdv:ZoomOutBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomOut}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomOutCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <dxdv:ZoomBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Zoom}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                    <dxdv:ZoomInBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomIn}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomInCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                    <dxb:BarItemLinkSeparator />
                    <bars:ExportSplitItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Export}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ExportSplitCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                    <bars:SendSplitItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Send}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SendSplitCommand, RelativeSource={RelativeSource TemplatedParent}}"/>

                    <bars:WatermarkBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Watermark}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SetWatermarkCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                </dxb:ToolBarControl>
            </dxb:BarContainerControl>
            <ContentControl Grid.Row="1" ContentTemplate="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}}" />
            <dxb:StatusBarControl Grid.Row="2" Caption="{local:PrintingStringId StringId=StatusBarCaption}">
                <bars:PageNumberEditItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PageNumber}"
                    SettingsSource="{Binding Path=(local:DocumentPreviewControl.ActualViewer), RelativeSource={RelativeSource TemplatedParent}}" />
                <bars:ProgressEditItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Progress}" ProgressSettings="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document, RelativeSource={RelativeSource TemplatedParent}, FallbackValue={x:Null}}"/>
                <bars:StopPageBuildItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.StopBuilding}" Command="{Binding  Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.StopPageBuildingCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
            </dxb:StatusBarControl>
        </Grid>
    </DataTemplate>

    <Style TargetType="{x:Type dxr:RibbonControl}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=RibbonStyle}">
        <Setter Property="ToolbarShowMode" Value="Hide" />
        <Setter Property="RibbonTitleBarVisibility" Value="Collapsed" />
        <Setter Property="RibbonStyle" Value="Office2010" />
    </Style>

    <DataTemplate x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=RibbonTemplate}">
        <Grid>
            <mvvm:Interaction.Behaviors>
                <dxb:ControllerBehavior Actions="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.Actions, RelativeSource={RelativeSource TemplatedParent}}" ExecutionMode="OnEvent">
                    <dxb:ControllerBehavior.Triggers>
                        <dxb:ActionTrigger EventName="Loaded" ExecuteOnce="True"/>
                    </dxb:ControllerBehavior.Triggers>
                </dxb:ControllerBehavior>
            </mvvm:Interaction.Behaviors>
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="auto" />
            </Grid.RowDefinitions>
            <dxr:RibbonControl Style="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=RibbonStyle}}">
                <dxr:RibbonControl.ApplicationMenu>
                    <dxr:ApplicationMenu Name="menu">
                        <dxb:BarButtonItemLink BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Open}" />
                        <dxb:BarButtonItemLink BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Save}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItemLink BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Print}" />
                    </dxr:ApplicationMenu>
                </dxr:RibbonControl.ApplicationMenu>
                <mvvm:Interaction.Behaviors>
                    <dxb:ControllerBehavior Actions="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.RibbonActions, RelativeSource={RelativeSource TemplatedParent}}" ExecutionMode="OnEvent">
                        <dxb:ControllerBehavior.Triggers>
                            <dxb:ActionTrigger EventName="Loaded" ExecuteOnce="True"/>
                        </dxb:ControllerBehavior.Triggers>
                    </dxb:ControllerBehavior>
                </mvvm:Interaction.Behaviors>
                <dxr:RibbonDefaultPageCategory>
                    <dxr:RibbonPage local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PreviewPage}"
                                    Caption="{local:PrintingStringId StringId=RibbonPageCaption}">
                        <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_File}" 
                                             local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.FileGroup}">
                            <dxdv:OpenDocumentBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Open}"  Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.OpenDocumentCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                            <bars:SaveBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Save}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SaveCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxr:RibbonPageGroup>

                        <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Print}" 
                                             local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PrintGroup}">
                            <bars:PrintBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Print}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                            <bars:PrintDirectBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PrintDirect}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PrintDirectCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                            <bars:PageSetupBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PageSetup}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PageSetupCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                            <bars:ScaleBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Scale}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ScaleCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxr:RibbonPageGroup>

                        <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Navigation}" 
                                             local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.NavigationGroup}">
                            <bars:FirstPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.FirstPage}"  Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.FirstPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                            <dxdv:PreviousPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PreviousPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.PreviousPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                            <dxdv:NextPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.NextPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.NextPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                            <bars:LastPageBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.LastPage}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.LastPageCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxr:RibbonPageGroup>

                        <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Zoom}" 
                                             local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomGroup}">
                            <dxdv:ZoomOutBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomOut}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomOutCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                            <dxdv:ZoomBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Zoom}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                            <dxdv:ZoomInBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ZoomIn}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ZoomInCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxr:RibbonPageGroup>

                        <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Export}" 
                                             local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.ExportGroup}">
                            <bars:ExportSplitItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Export}"  Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ExportSplitCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                            <bars:SendSplitItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Send}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SendSplitCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                        </dxr:RibbonPageGroup>

                        <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Document}" 
                                             local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.DocumentGroup}">
                            <bars:ParametersBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Parameters}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleParametersPanelCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                            <bars:DocumentMapBarCheckItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.DocumentMap}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ToggleDocumentMapCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                            <bars:FindTextBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Find}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.ShowFindTextCommand, RelativeSource={RelativeSource TemplatedParent}}" CommandParameter="{StaticResource TrueBoolean}" />
                        </dxr:RibbonPageGroup>

                        <dxr:RibbonPageGroup Caption="{local:PrintingStringId StringId=RibbonPageGroup_Watermark}" 
                                             local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.WatermarkGroup}">
                            <bars:WatermarkBarItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Watermark}" Command="{Binding Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.SetWatermarkCommand, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxr:RibbonPageGroup>
                    </dxr:RibbonPage>
                </dxr:RibbonDefaultPageCategory>
                
            </dxr:RibbonControl>
            <ContentControl Grid.Row="1" ContentTemplate="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}}" />
            <dxr:RibbonStatusBarControl Grid.Row="2">
                <dxr:RibbonStatusBarControl.LeftItems>
                    <bars:PageNumberEditItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.PageNumber}"
                                             SettingsSource="{Binding Path=(local:DocumentPreviewControl.ActualViewer), RelativeSource={RelativeSource TemplatedParent}}" />
                    <bars:ProgressEditItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.Progress}" ProgressSettings="{Binding Path=(local:DocumentPreviewControl.ActualViewer).Document, RelativeSource={RelativeSource TemplatedParent}, FallbackValue={x:Null}}"/>
                    <bars:StopPageBuildItem local:DocumentPreviewControl.BarItemName="{x:Static bars:DefaultPreviewBarItemNames.StopBuilding}" Command="{Binding  Path=(local:DocumentPreviewControl.ActualViewer).ActualCommandProvider.StopPageBuildingCommand, RelativeSource={RelativeSource TemplatedParent}}"/>
                </dxr:RibbonStatusBarControl.LeftItems>
            </dxr:RibbonStatusBarControl>
        </Grid>
    </DataTemplate>
    

    <ControlTemplate TargetType="{x:Type native:PreviewScrollViewer}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=ScrollViewerTemplate}">
        <Grid x:Name="Grid" Background="{TemplateBinding Background}" Margin="{TemplateBinding Margin}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <ScrollContentPresenter x:Name="PART_ScrollContentPresenter"
                                    Margin="{TemplateBinding Padding}"
				                    CanContentScroll="{TemplateBinding CanContentScroll}"
				                    CanHorizontallyScroll="False"
				                    CanVerticallyScroll="False">
                <Grid.RowSpan>
                    <Binding Path="(dxc:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource TemplatedParent}">
                        <Binding.Converter>
                            <dxc:EnumToObjectConverter DefaultValue="1">
                                <dxc:EnumToObjectConverter.Values>
                                    <dxc:EnumObjectProvider x:Key="TouchOverlap" Value="2"/>
                                </dxc:EnumToObjectConverter.Values>
                            </dxc:EnumToObjectConverter>
                        </Binding.Converter>
                    </Binding>
                </Grid.RowSpan>
                <Grid.ColumnSpan>
                    <Binding Path="(dxc:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource TemplatedParent}">
                        <Binding.Converter>
                            <dxc:EnumToObjectConverter DefaultValue="1">
                                <dxc:EnumToObjectConverter.Values>
                                    <dxc:EnumObjectProvider x:Key="TouchOverlap" Value="2"/>
                                </dxc:EnumToObjectConverter.Values>
                            </dxc:EnumToObjectConverter>
                        </Binding.Converter>
                    </Binding>
                </Grid.ColumnSpan>
            </ScrollContentPresenter>
            <ScrollBar Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" Cursor="Arrow" x:Name="PART_VerticalScrollBar" Grid.Column="1" Grid.Row="0" ViewportSize="{TemplateBinding ViewportHeight}" Maximum="{TemplateBinding ScrollableHeight}" Minimum="0" Value="{Binding Path=VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" AutomationProperties.AutomationId="VerticalScrollBar" >
                <Grid.RowSpan>
                    <MultiBinding>
                        <MultiBinding.Bindings>
                            <Binding Path="(dxc:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource Self}"/>
                            <Binding Path="(dxc:ScrollBarExtensions.ScrollViewerOrientation)" RelativeSource="{RelativeSource TemplatedParent}"/>
                        </MultiBinding.Bindings>
                        <MultiBinding.Converter>
                            <dxc:VerticalScrollBarRowSpanConverter/>
                        </MultiBinding.Converter>
                    </MultiBinding>
                </Grid.RowSpan>
            </ScrollBar>
            <ScrollBar Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" Cursor="Arrow" x:Name="PART_HorizontalScrollBar" Grid.Column="0" Grid.Row="1" Orientation="Horizontal" ViewportSize="{TemplateBinding ViewportWidth}" Maximum="{TemplateBinding ScrollableWidth}" Minimum="0" Value="{Binding Path=HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" AutomationProperties.AutomationId="HorizontalScrollBar" >
                <Grid.ColumnSpan>
                    <MultiBinding>
                        <MultiBinding.Bindings>
                            <Binding Path="(dxc:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource Self}"/>
                            <Binding Path="(dxc:ScrollBarExtensions.ScrollViewerOrientation)" RelativeSource="{RelativeSource TemplatedParent}"/>
                        </MultiBinding.Bindings>
                        <MultiBinding.Converter>
                            <dxc:HorizontalScrollBarRowSpanConverter/>
                        </MultiBinding.Converter>
                    </MultiBinding>
                </Grid.ColumnSpan>
            </ScrollBar>
            <Border x:Name="Corner" Grid.Row="1" Grid.Column="1" Style="{DynamicResource {dxt:ScrollBarThemeKey ResourceKey=ScrollingCornerStyle}}" >
                <Border.Visibility>
                    <Binding Path="(dxc:ScrollBarExtensions.ScrollBarMode)" RelativeSource="{RelativeSource TemplatedParent}">
                        <Binding.Converter>
                            <dxc:EnumToObjectConverter DefaultValue="Visible">
                                <dxc:EnumToObjectConverter.Values>
                                    <dxc:EnumObjectProvider x:Key="TouchOverlap" Value="Collapsed"/>
                                </dxc:EnumToObjectConverter.Values>
                            </dxc:EnumToObjectConverter>
                        </Binding.Converter>
                    </Binding>
                </Border.Visibility>
            </Border>
            <dxe:FlyoutControl
                x:Name="PART_FlyoutControl"
                PlacementTarget="{Binding ElementName=PART_VerticalScrollBar}"
                VerticalAlignment="Center"
                AllowMoveAnimation="False"
                ContentTemplate="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PaginationTemplate}}"
                IsOpen="False">
                <dxe:FlyoutControl.Settings>
                    <dxe:FlyoutSettings Placement="Left" ShowIndicator="True"/>
                </dxe:FlyoutControl.Settings>
            </dxe:FlyoutControl>
        </Grid>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type native:SelectionCanvas}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasTemplate}">
        <Canvas x:Name="PART_SelectionCanvas" ClipToBounds="True">
            <ContentControl Canvas.Left="{Binding Path=(SelectionRectangle).X, RelativeSource={RelativeSource TemplatedParent}}"
                            Canvas.Top="{Binding Path=(SelectionRectangle).Y, RelativeSource={RelativeSource TemplatedParent}}"
                            Width="{Binding Path=(SelectionRectangle).Width, RelativeSource={RelativeSource TemplatedParent}}"
                            Height="{Binding Path=(SelectionRectangle).Height, RelativeSource={RelativeSource TemplatedParent}}"
                            ContentTemplate="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasContentTemplate}}"
                            Content="{Binding Path=SelectionRectangle, RelativeSource={RelativeSource TemplatedParent}}"
                            Focusable="False"/>
        </Canvas>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type native:PageSelector}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=PageSelectorTemplate}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="{Binding Path=VerticalScrollBarWidth, ElementName=PART_ScrollViewer}"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Decorator Focusable="True" x:Name="PART_Decorator" FocusVisualStyle="{x:Null}" Grid.RowSpan="2" Grid.ColumnSpan="2">
                <Grid>
                    <native:PreviewScrollViewer x:Name="PART_ScrollViewer"  FlowDirection="{Binding FlowDirection, RelativeSource={RelativeSource AncestorType=local:DocumentPreviewControl}}"
                                                CanMouseScroll="{Binding Path=(local:DocumentPreviewControl.ActualViewer).CursorMode, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource cursorModeToCanMouseScrollConverter}}" 
                                                Focusable="false" Padding="{TemplateBinding Padding}" Template="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=ScrollViewerTemplate}}"
                                     HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" CanContentScroll="True">
                        <mvvm:Interaction.Behaviors>
                            <native:CursorAttachedBehavior CursorMode="{Binding Path=(local:DocumentPreviewControl.ActualViewer).CursorMode, RelativeSource={RelativeSource TemplatedParent}}" />
                            <dxc:ScrollViewerTouchBehavior Orientation="Vertical"/>
                        </mvvm:Interaction.Behaviors>
                        <ItemsPresenter x:Name="PART_ItemsPresenter" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    </native:PreviewScrollViewer>
                </Grid>
            </Decorator>
            <dxc:DXExpander 
                IsExpanded="{Binding Path=IsSearchControlVisible, RelativeSource={RelativeSource TemplatedParent}}" 
                VerticalAlignment="Top" 
                HorizontalAlignment="Stretch" 
                Opacity="{Binding Path=AnimationProgress, RelativeSource={RelativeSource Self}}">
                <dxdv:SearchControlContainer
                    IsSearchControlVisible="{Binding Path=IsSearchControlVisible, RelativeSource={RelativeSource TemplatedParent}}"
                    SearchParameter="{Binding Path=SearchParameter, RelativeSource={RelativeSource TemplatedParent}}">
                </dxdv:SearchControlContainer>
            </dxc:DXExpander>
        </Grid>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type local:DocumentPresenterControl}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=DocumentPresenterTemplate}">
        <Grid>
            <Grid Name="renderContainer">
                <dxe:NativeImage x:Name="PART_NativeImage"/>
                <native:PageSelector x:Name="PART_ItemsControl" 
                                    Background="Transparent" 
                                    IsSearchControlVisible ="{Binding Path=IsSearchControlVisible, RelativeSource={RelativeSource TemplatedParent}}"
                                    SearchParameter ="{Binding Path=SearchParameter, RelativeSource={RelativeSource TemplatedParent}}"
                                    VirtualizingStackPanel.VirtualizationMode="Recycling">
                    <native:PageSelector.ItemsPanel>
                        <ItemsPanelTemplate>
                            <dxdv:DocumentViewerPanel Name="itemsHost" IsItemsHost="True" FlowDirection="LeftToRight"/>
                        </ItemsPanelTemplate>
                    </native:PageSelector.ItemsPanel>
                </native:PageSelector>
                <native:SelectionCanvas SelectionRectangle="{Binding Path=SelectionRectangle, RelativeSource={RelativeSource TemplatedParent}}" />
            </Grid>
        </Grid>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type local:DocumentPreviewControl}" x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=Template}">
        <ContentControl Grid.RowSpan="3" Focusable="False" Grid.ColumnSpan="3" Content="{Binding Path=ActualCommandProvider, RelativeSource={RelativeSource TemplatedParent}}" 
            ContentTemplate="{Binding Path=ActualBarsTemplate, RelativeSource={RelativeSource TemplatedParent}}">
        </ContentControl>
    </ControlTemplate>
    
    <Style TargetType="{x:Type local:PreviewPageControlItem}" >
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PageControlItemTemplate}}" />
    </Style>

    <Style TargetType="{x:Type native:SelectionCanvas}">
        <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=SelectionCanvasTemplate}}" />
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="IsHitTestVisible" Value="False" />
    </Style>

    <Style TargetType="{x:Type native:PageSelector}">
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PageSelectorTemplate}}"/>
    </Style>

    <Style TargetType="{x:Type local:DocumentPresenterControl}">
        <Setter Property="MinHeight" Value="10" />
        <Setter Property="FlowDirection" Value="LeftToRight"/>
        <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=DocumentPresenterTemplate}}" />
    </Style>

    <Style TargetType="{x:Type local:DocumentPreviewControl}">
        <Setter Property="HighlightSelectionColor" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=HighlightSelectionColor}}" />
        <Setter Property="BarsTemplate" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=BarsTemplate}}" />
        <Setter Property="RibbonTemplate" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=RibbonTemplate}}" />
        <Setter Property="PresenterTemplate" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=PresenterTemplate}}" />
        <Setter Property="Template" Value="{DynamicResource {themes:NewDocumentViewerThemeKey ResourceKey=Template}}" />
    </Style>
    <Style x:Key="{themes:NewDocumentViewerThemeKey ResourceKey=ExportOptionsDialogStyle}" TargetType="{x:Type dxc:DXDialogWindow}">
        <Setter Property="dxe:ValidationService.IsValidationContainer" Value="True"/>
        <Setter Property="SizeToContent" Value="WidthAndHeight" />
        <Setter Property="WindowStyle" Value="ToolWindow" />
        <Setter Property="ResizeMode" Value="NoResize" />
        <Setter Property="ShowInTaskbar" Value="False" />
    </Style>
</ResourceDictionary>